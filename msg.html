<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mehbub ‚ù§Ô∏è Minuwara</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        /* --- LOVE THEME CSS --- */
        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: #ffe6e6;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            overflow: hidden;
        }

        /* Animated Background Hearts */
        .bg-hearts {
            position: absolute;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }
        .heart-bg {
            position: absolute;
            bottom: -20px;
            color: rgba(255, 105, 180, 0.3);
            animation: floatUp linear infinite;
        }
        @keyframes floatUp {
            to { transform: translateY(-110vh) rotate(360deg); opacity: 0; }
        }

        /* Chat Container */
        .chat-app {
            width: 100%;
            max-width: 400px; /* Mobile size like WhatsApp */
            height: 100vh;
            background: #fff;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            position: relative;
        }

        /* Header */
        .header {
            background: linear-gradient(to right, #ff416c, #ff4b2b);
            color: white;
            padding: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .profile-pic {
            width: 40px;
            height: 40px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #ff416c;
            font-weight: bold;
        }
        .header-info h3 { margin: 0; font-size: 1rem; }
        .header-info span { font-size: 0.75rem; opacity: 0.9; }

        /* Chat Area */
        #messages-container {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            background-image: url('https://i.pinimg.com/originals/97/c0/07/97c00759d90d786d9b6096d274ad3e07.png'); /* WhatsApp Doodle style bg */
            background-size: 300px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        /* Messages */
        .message-bubble {
            max-width: 70%;
            padding: 8px 12px;
            border-radius: 15px;
            font-size: 0.9rem;
            position: relative;
            word-wrap: break-word;
            box-shadow: 0 1px 1px rgba(0,0,0,0.1);
        }
        
        /* My Message (Right) */
        .my-msg {
            align-self: flex-end;
            background: #ff4b2b;
            color: white;
            border-bottom-right-radius: 2px;
        }
        
        /* Her Message (Left) */
        .other-msg {
            align-self: flex-start;
            background: white;
            color: #333;
            border-bottom-left-radius: 2px;
        }

        .time-tick {
            font-size: 0.65rem;
            text-align: right;
            margin-top: 4px;
            opacity: 0.7;
            display: flex;
            justify-content: flex-end;
            align-items: center;
            gap: 3px;
        }

        /* Input Area */
        .input-area {
            padding: 10px;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        input {
            flex: 1;
            padding: 12px;
            border-radius: 25px;
            border: none;
            outline: none;
            font-size: 1rem;
        }
        .send-btn {
            background: #ff416c;
            color: white;
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            transition: 0.2s;
        }
        .send-btn:active { transform: scale(0.9); }

        /* Login Screen */
        #login-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #ffe6e6;
            z-index: 100;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .login-box {
            background: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .btn-select {
            display: block;
            width: 200px;
            padding: 12px;
            margin: 10px 0;
            background: #ff416c;
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 1rem;
            cursor: pointer;
        }
    </style>
</head>
<body>

    <div class="bg-hearts" id="bg-hearts"></div>

    <div id="login-screen">
        <div class="login-box">
            <h2 style="color: #ff416c;">‚ù§Ô∏è Welcome to Love Chat ‚ù§Ô∏è</h2>
            <p>Who are you?</p>
            <button class="btn-select" onclick="login('Mehbub Ali')">üë® Mehbub Ali</button>
            <button class="btn-select" onclick="login('Minuwara Khatun')">üë© Minuwara Khatun</button>
        </div>
    </div>

    <div class="chat-app" id="chat-app" style="display: none;">
        <div class="header">
            <div class="profile-pic" id="header-initial">M</div>
            <div class="header-info">
                <h3 id="chat-with-name">Partner</h3>
                <span><i class="fas fa-circle" style="color: #90ee90; font-size: 8px;"></i> Online</span>
            </div>
        </div>

        <div id="messages-container"></div>

        <div class="input-area">
            <input type="text" id="msg-input" placeholder="Type a message..." autocomplete="off">
            <button class="send-btn" onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>

    <script type="module">
        // Import Firebase Functions (Ye wo free server API hai)
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
        import { getDatabase, ref, push, onChildAdded } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";

        // --- üî¥ IMP: NICHE WALA HISSA BADALNA HAI APNI KEY SE üî¥ ---
        const firebaseConfig = {
            apiKey: "AIzaSy...APNI_KEY_YAHAN_DALO",
            authDomain: "love-chat.firebaseapp.com",
            databaseURL: "https://love-chat-default-rtdb.firebaseio.com",
            projectId: "love-chat",
            storageBucket: "love-chat.appspot.com",
            messagingSenderId: "123456",
            appId: "1:123456"
        };
        // -----------------------------------------------------------

        // Server Start
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const chatRef = ref(db, 'messages'); // 'messages' folder in server

        let myName = "";

        // Login Function
        window.login = function(name) {
            myName = name;
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('chat-app').style.display = 'flex';
            
            // Set Header Name (Agar main Mehbub hun, to upar Minuwara dikhega)
            let partnerName = (name === 'Mehbub Ali') ? 'Minuwara Khatun' : 'Mehbub Ali';
            document.getElementById('chat-with-name').innerText = partnerName;
            document.getElementById('header-initial').innerText = partnerName.charAt(0);
        }

        // 1. MESSAGE BHEJNE KA CODE (Send to Server)
        window.sendMessage = function() {
            let input = document.getElementById('msg-input');
            let text = input.value.trim();
            
            if(text !== "") {
                // Server par data push karo
                push(chatRef, {
                    sender: myName,
                    text: text,
                    time: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})
                });
                input.value = ""; // Clear input
            }
        }

        // Enter key se send karna
        document.getElementById('msg-input').addEventListener("keypress", function(event) {
            if (event.key === "Enter") window.sendMessage();
        });

        // 2. MESSAGE RECEIVE KARNE KA CODE (Listen from Server)
        // Ye "onChildAdded" function magic hai. Jaise hi server par naya message aata hai, ye run hota hai.
        onChildAdded(chatRef, (snapshot) => {
            const data = snapshot.val();
            addMessageToScreen(data.sender, data.text, data.time);
        });

        function addMessageToScreen(sender, text, time) {
            const container = document.getElementById('messages-container');
            const div = document.createElement('div');
            
            // Check karo message mera hai ya uska
            const isMe = (sender === myName);
            div.className = `message-bubble ${isMe ? 'my-msg' : 'other-msg'}`;
            
            div.innerHTML = `
                ${text}
                <div class="time-tick">${time} ${isMe ? '<i class="fas fa-check-double"></i>' : ''}</div>
            `;
            
            container.appendChild(div);
            container.scrollTop = container.scrollHeight; // Auto scroll down
        }

        // Background Hearts Logic
        setInterval(() => {
            const heart = document.createElement('div');
            heart.classList.add('heart-bg');
            heart.innerHTML = '‚ù§Ô∏è';
            heart.style.left = Math.random() * 100 + 'vw';
            heart.style.fontSize = Math.random() * 20 + 10 + 'px';
            heart.style.animationDuration = Math.random() * 3 + 2 + 's';
            document.getElementById('bg-hearts').appendChild(heart);
            setTimeout(() => heart.remove(), 5000);
        }, 500);

    </script>
</body>
</html>
